<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="523px" preserveAspectRatio="none" style="width:740px;height:523px;" version="1.1" viewBox="0 0 740 523" width="740px" zoomAndPan="magnify"><defs><filter height="300%" id="f1d5oxnyhy8nb6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="282.25" y="22.9951">Subscription Observer</text><rect fill="#FFFFFF" filter="url(#f1d5oxnyhy8nb6)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="68" y="281.2578"/><rect fill="#FFFFFF" filter="url(#f1d5oxnyhy8nb6)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="217" y="112.5938"/><rect fill="#FFFFFF" filter="url(#f1d5oxnyhy8nb6)" height="222.7344" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="389.5" y="227.9922"/><rect fill="#FFFFFF" filter="url(#f1d5oxnyhy8nb6)" height="179.6016" style="stroke: #000000; stroke-width: 2.0;" width="716.5" x="13" y="243.125"/><rect fill="#FFFFFF" filter="url(#f1d5oxnyhy8nb6)" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="414" x="305.5" y="325.5234"/><rect fill="#FFFFFF" height="43.9375" style="stroke: none; stroke-width: 1.0;" width="414" x="305.5" y="371.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73" x2="73" y1="81.5938" y2="178.9922"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="73" x2="73" y1="178.9922" y2="206.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73" x2="73" y1="206.9922" y2="468.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="221.5" x2="221.5" y1="81.5938" y2="178.9922"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="221.5" x2="221.5" y1="178.9922" y2="206.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="221.5" x2="221.5" y1="206.9922" y2="468.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="394.5" y1="81.5938" y2="178.9922"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="394.5" x2="394.5" y1="178.9922" y2="206.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="394.5" y1="206.9922" y2="468.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="596.5" x2="596.5" y1="81.5938" y2="178.9922"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="596.5" x2="596.5" y1="178.9922" y2="206.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="596.5" x2="596.5" y1="206.9922" y2="468.8594"/><rect fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="23" y="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="30" y="66.292">DataReader</text><rect fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="23" y="467.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="30" y="487.8545">DataReader</text><rect fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="138.5" y="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="149" x="145.5" y="66.292">SubscriptionObserver</text><rect fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="138.5" y="467.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="149" x="145.5" y="487.8545">SubscriptionObserver</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="315.5" y="78.292">SingleThreadExecutor</text><ellipse cx="394.5" cy="49.2969" fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="390.5,37.2969,396.5,32.2969,394.5,37.2969,396.5,42.2969,390.5,37.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="315.5" y="480.8545">SingleThreadExecutor</text><ellipse cx="394.5" cy="500.1563" fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="390.5,488.1563,396.5,483.1563,394.5,488.1563,396.5,493.1563,390.5,488.1563" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="218" x="487.5" y="42.2969"/><rect fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="218" x="483.5" y="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="204" x="490.5" y="66.292">SubscriptionObserverListener</text><rect fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="218" x="487.5" y="467.8594"/><rect fill="#FEFECE" filter="url(#f1d5oxnyhy8nb6)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="218" x="483.5" y="471.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="204" x="490.5" y="491.8545">SubscriptionObserverListener</text><rect fill="#FFFFFF" filter="url(#f1d5oxnyhy8nb6)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="68" y="281.2578"/><rect fill="#FFFFFF" filter="url(#f1d5oxnyhy8nb6)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="217" y="112.5938"/><rect fill="#FFFFFF" filter="url(#f1d5oxnyhy8nb6)" height="222.7344" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="389.5" y="227.9922"/><polygon fill="#A80036" points="205,108.5938,215,112.5938,205,116.5938,209,112.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73" x2="211" y1="112.5938" y2="112.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="80" y="107.6606">on_data_available()</text><polygon fill="#A80036" points="382.5,137.7266,392.5,141.7266,382.5,145.7266,386.5,141.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="227" x2="388.5" y1="141.7266" y2="141.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="234" y="136.7935">submit()</text><polygon fill="#A80036" points="84,166.8594,74,170.8594,84,174.8594,80,170.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="78" x2="221" y1="170.8594" y2="170.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="90" y="165.9263">done</text><polygon fill="#A80036" points="377.5,223.9922,387.5,227.9922,377.5,231.9922,381.5,227.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="383.5" y1="227.9922" y2="227.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="10" y="223.0591">run()</text><rect fill="none" height="179.6016" style="stroke: #000000; stroke-width: 2.0;" width="716.5" x="13" y="243.125"/><polygon fill="#EEEEEE" points="13,243.125,90,243.125,90,250.125,80,260.125,13,260.125,13,243.125" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="28" y="256.1919">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="246" x="105" y="255.3354">[RETCODE_NO_DATA|RETCODE_ERROR]</text><polygon fill="#A80036" points="89,277.2578,79,281.2578,89,285.2578,85,281.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83" x2="388.5" y1="281.2578" y2="281.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="95" y="276.3247">read_next_sample_untyped()</text><polygon fill="#A80036" points="377.5,306.3906,387.5,310.3906,377.5,314.3906,381.5,310.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="73" x2="383.5" y1="310.3906" y2="310.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="80" y="305.4575">sample, sampleInfo</text><rect fill="none" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="414" x="305.5" y="325.5234"/><polygon fill="#EEEEEE" points="305.5,325.5234,369.5,325.5234,369.5,332.5234,359.5,342.5234,305.5,342.5234,305.5,325.5234" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="320.5" y="338.5903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="194" x="384.5" y="337.7339">[sampleInfo.valid_data = true]</text><polygon fill="#A80036" points="584.5,359.6563,594.5,363.6563,584.5,367.6563,588.5,363.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399.5" x2="590.5" y1="363.6563" y2="363.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="406.5" y="358.7231">subscriptionDiscovered()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="305.5" x2="719.5" y1="372.7891" y2="372.7891"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="200" x="310.5" y="382.9995">[sampleInfo.valid_data = false]</text><polygon fill="#A80036" points="584.5,403.5938,594.5,407.5938,584.5,411.5938,588.5,407.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399.5" x2="590.5" y1="407.5938" y2="407.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="406.5" y="402.6606">subscriptionLost()</text><polygon fill="#A80036" points="14,446.7266,4,450.7266,14,454.7266,10,450.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="8" x2="393.5" y1="450.7266" y2="450.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="20" y="445.7935">done</text><!--
@startuml
title Subscription Observer

participant DataReader
participant SubscriptionObserver
control SingleThreadExecutor
collections SubscriptionObserverListener

DataReader -> SubscriptionObserver: on_data_available()
activate SubscriptionObserver

SubscriptionObserver -> SingleThreadExecutor: submit()
SubscriptionObserver - -> DataReader: done
deactivate SubscriptionObserver
...
[-> SingleThreadExecutor: run()
activate SingleThreadExecutor
loop RETCODE_NO_DATA|RETCODE_ERROR

  SingleThreadExecutor -> DataReader: read_next_sample_untyped()
  activate DataReader
  DataReader - -> SingleThreadExecutor: sample, sampleInfo
  deactivate DataReader

  alt sampleInfo.valid_data = true
    SingleThreadExecutor -> SubscriptionObserverListener: subscriptionDiscovered()
  else sampleInfo.valid_data = false
    SingleThreadExecutor -> SubscriptionObserverListener: subscriptionLost()
  end
end
[<- - SingleThreadExecutor: done
deactivate SingleThreadExecutor
@enduml

PlantUML version 1.2017.15(Mon Jul 03 18:45:34 CEST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1024-b8
Operating System: Linux
OS Version: 3.10.0-693.11.1.el7.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>