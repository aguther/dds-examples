<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="425px" preserveAspectRatio="none" style="width:1118px;height:425px;" version="1.1" viewBox="0 0 1118 425" width="1118px" zoomAndPan="magnify"><defs><filter height="300%" id="f1tglg79w5riye" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="344" x="382.5" y="22.9951">DynamicPartitionObserver : Ignore Partition</text><rect fill="#FFFFFF" filter="url(#f1tglg79w5riye)" height="192.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="322" y="159.5938"/><rect fill="#FFFFFF" filter="url(#f1tglg79w5riye)" height="29.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="546.5" y="204.125"/><rect fill="#FFFFFF" filter="url(#f1tglg79w5riye)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="546.5" y="286.6563"/><rect fill="#FFFFFF" filter="url(#f1tglg79w5riye)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="459" x="219" y="248.5234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="113" x2="113" y1="81.5938" y2="371.0547"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="327" x2="327" y1="81.5938" y2="371.0547"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="551" x2="551" y1="81.5938" y2="371.0547"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="757" x2="757" y1="81.5938" y2="371.0547"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="973" x2="973" y1="81.5938" y2="371.0547"/><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="207" x="8" y="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="193" x="15" y="66.292">PublicationObserverListener</text><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="207" x="8" y="370.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="193" x="15" y="390.0498">PublicationObserverListener</text><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="192" x="229" y="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="178" x="236" y="66.292">DynamicPartitionObserver</text><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="192" x="229" y="370.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="178" x="236" y="390.0498">DynamicPartitionObserver</text><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="439" y="42.2969"/><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="435" y="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="211" x="442" y="66.292">DynamicPartitionObserverFilter</text><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="439" y="370.0547"/><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="435" y="374.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="211" x="442" y="394.0498">DynamicPartitionObserverFilter</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="678" y="78.292">SingleThreadExecutor</text><ellipse cx="757" cy="49.2969" fill="#FEFECE" filter="url(#f1tglg79w5riye)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="753,37.2969,759,32.2969,757,37.2969,759,42.2969,753,37.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="678" y="383.0498">SingleThreadExecutor</text><ellipse cx="757" cy="402.3516" fill="#FEFECE" filter="url(#f1tglg79w5riye)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="753,390.3516,759,385.3516,757,390.3516,759,395.3516,753,390.3516" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="247" x="850" y="42.2969"/><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="247" x="846" y="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="233" x="853" y="66.292">DynamicPartitionObserverListener</text><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="247" x="850" y="370.0547"/><rect fill="#FEFECE" filter="url(#f1tglg79w5riye)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="247" x="846" y="374.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="233" x="853" y="394.0498">DynamicPartitionObserverListener</text><rect fill="#FFFFFF" filter="url(#f1tglg79w5riye)" height="192.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="322" y="159.5938"/><rect fill="#FFFFFF" filter="url(#f1tglg79w5riye)" height="29.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="546.5" y="204.125"/><rect fill="#FFFFFF" filter="url(#f1tglg79w5riye)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="546.5" y="286.6563"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="3" x2="1106" y1="92.5938" y2="92.5938"/><polygon fill="#A80036" points="310,155.5938,320,159.5938,310,163.5938,314,159.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="113.5" x2="316" y1="159.5938" y2="159.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="120.5" y="109.6606">publicationLost()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="120.5" y="124.7935">subscriptionLost()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="120.5" y="139.9263">publicationDiscovered()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="120.5" y="155.0591">subscriptionDiscovered()</text><polygon fill="#A80036" points="534.5,200.125,544.5,204.125,534.5,208.125,538.5,204.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="540.5" y1="204.125" y2="204.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="339" y="184.1919">ignorePublication()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="339" y="199.3247">ignoreSubscription()</text><polygon fill="#A80036" points="343,229.3906,333,233.3906,343,237.3906,339,233.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="337" x2="550.5" y1="233.3906" y2="233.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="349" y="228.4575">false</text><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="459" x="219" y="248.5234"/><polygon fill="#EEEEEE" points="219,248.5234,296,248.5234,296,255.5234,286,265.5234,219,265.5234,219,248.5234" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="234" y="261.5903">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="311" y="260.7339">[partitions]</text><polygon fill="#A80036" points="534.5,282.6563,544.5,286.6563,534.5,290.6563,538.5,286.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="540.5" y1="286.6563" y2="286.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="339" y="281.7231">ignorePartition()</text><polygon fill="#A80036" points="343,311.7891,333,315.7891,343,319.7891,339,315.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="337" x2="550.5" y1="315.7891" y2="315.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="349" y="310.856">true</text><polygon fill="#A80036" points="124.5,347.9219,114.5,351.9219,124.5,355.9219,120.5,351.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="118.5" x2="326" y1="351.9219" y2="351.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="130.5" y="346.9888">done</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="3" x2="1106" y1="360.0547" y2="360.0547"/><!--
@startuml
title DynamicPartitionObserver : Ignore Publication/Subscription

participant PublicationObserverListener
participant DynamicPartitionObserver
collections DynamicPartitionObserverFilter

PublicationObserverListener -> DynamicPartitionObserver: publicationLost()\nsubscriptionLost()\npublicationDiscovered()\nsubscriptionDiscovered()
activate DynamicPartitionObserver
  DynamicPartitionObserver -> DynamicPartitionObserverFilter: ignorePublication()\nignoreSubscription()
  activate DynamicPartitionObserverFilter
    DynamicPartitionObserverFilter - -> DynamicPartitionObserver: true
  deactivate DynamicPartitionObserverFilter
  DynamicPartitionObserver - -> PublicationObserverListener: done
deactivate DynamicPartitionObserver

newPage DynamicPartitionObserver : Ignore Partition

participant PublicationObserverListener
participant DynamicPartitionObserver
collections DynamicPartitionObserverFilter

PublicationObserverListener -> DynamicPartitionObserver: publicationLost()\nsubscriptionLost()\npublicationDiscovered()\nsubscriptionDiscovered()
activate DynamicPartitionObserver

DynamicPartitionObserver -> DynamicPartitionObserverFilter: ignorePublication()\nignoreSubscription()
activate DynamicPartitionObserverFilter
  DynamicPartitionObserverFilter - -> DynamicPartitionObserver: false
deactivate DynamicPartitionObserverFilter

loop partitions
  DynamicPartitionObserver -> DynamicPartitionObserverFilter: ignorePartition()
  activate DynamicPartitionObserverFilter
      DynamicPartitionObserverFilter - -> DynamicPartitionObserver: true
  deactivate DynamicPartitionObserverFilter
end

DynamicPartitionObserver - -> PublicationObserverListener: done
deactivate DynamicPartitionObserver

newPage DynamicPartitionObserver : Create Session, TopicRoute

participant PublicationObserverListener
participant DynamicPartitionObserver
collections DynamicPartitionObserverFilter
control SingleThreadExecutor
collections DynamicPartitionObserverListener

PublicationObserverListener -> DynamicPartitionObserver: publicationDiscovered()\nsubscriptionDiscovered()
activate DynamicPartitionObserver

DynamicPartitionObserver -> DynamicPartitionObserverFilter: ignorePublication()\nignoreSubscription()
activate DynamicPartitionObserverFilter
  DynamicPartitionObserverFilter - -> DynamicPartitionObserver: false
deactivate DynamicPartitionObserverFilter

loop partitions
  DynamicPartitionObserver -> DynamicPartitionObserverFilter: ignorePartition()
  activate DynamicPartitionObserverFilter
      DynamicPartitionObserverFilter - -> DynamicPartitionObserver: false
  deactivate DynamicPartitionObserverFilter

  alt !mapping.containsKey(session)
    DynamicPartitionObserver -> DynamicPartitionObserver: update mapping
    DynamicPartitionObserver -> SingleThreadExecutor: submit(createSession)
  end
  alt !mapping.get(session).containsKey(topicRoute)
    DynamicPartitionObserver -> SingleThreadExecutor: submit(createTopicRoute)
  end
  DynamicPartitionObserver -> DynamicPartitionObserver: update mapping
end

DynamicPartitionObserver - -> PublicationObserverListener: done
deactivate DynamicPartitionObserver

== Create Session ==

[-> SingleThreadExecutor: run()
activate SingleThreadExecutor
  SingleThreadExecutor -> DynamicPartitionObserverListener: createSession()
  [<- - SingleThreadExecutor: done
deactivate SingleThreadExecutor

== Create Topic Route ==

[-> SingleThreadExecutor: run()
activate SingleThreadExecutor
  SingleThreadExecutor -> DynamicPartitionObserverListener: createTopicRoute()
  [<- - SingleThreadExecutor: done
deactivate SingleThreadExecutor

newPage DynamicPartitionObserver : Delete Session, TopicRoute

participant PublicationObserverListener
participant DynamicPartitionObserver
collections DynamicPartitionObserverFilter
control SingleThreadExecutor
collections DynamicPartitionObserverListener

PublicationObserverListener -> DynamicPartitionObserver: publicationLost()\nsubscriptionLost()
activate DynamicPartitionObserver

DynamicPartitionObserver -> DynamicPartitionObserverFilter: ignorePublication()\nignoreSubscription()
activate DynamicPartitionObserverFilter
  DynamicPartitionObserverFilter - -> DynamicPartitionObserver: false
deactivate DynamicPartitionObserverFilter

loop partitions
  DynamicPartitionObserver -> DynamicPartitionObserverFilter: ignorePartition()
  activate DynamicPartitionObserverFilter
      DynamicPartitionObserverFilter - -> DynamicPartitionObserver: false
  deactivate DynamicPartitionObserverFilter

  DynamicPartitionObserver -> DynamicPartitionObserver: update mapping
  alt !mapping.get(session).containsKey(topicRoute)
    DynamicPartitionObserver -> SingleThreadExecutor: submit(deleteTopicRoute)
  end
  alt mapping.get(session).isEmpty()
    DynamicPartitionObserver -> DynamicPartitionObserver: update mapping
    DynamicPartitionObserver -> SingleThreadExecutor: submit(deleteSession)
  end
end

DynamicPartitionObserver - -> PublicationObserverListener: done
deactivate DynamicPartitionObserver

== Delete Session ==

[-> SingleThreadExecutor: run()
activate SingleThreadExecutor
  SingleThreadExecutor -> DynamicPartitionObserverListener: deleteSession()
  [<- - SingleThreadExecutor: done
deactivate SingleThreadExecutor

== Delete Topic Route ==

[-> SingleThreadExecutor: run()
activate SingleThreadExecutor
  SingleThreadExecutor -> DynamicPartitionObserverListener: deleteTopicRoute()
  [<- - SingleThreadExecutor: done
deactivate SingleThreadExecutor

@enduml

PlantUML version 1.2017.15(Mon Jul 03 18:45:34 CEST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1024-b8
Operating System: Linux
OS Version: 3.10.0-693.11.1.el7.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>